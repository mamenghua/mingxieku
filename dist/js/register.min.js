"use strict";function draw(a){var t="",e=a.width(),o=a.height(),r=a[0],n=r.getContext("2d");r.width=e,r.height=o;for(var l="A,B,C,E,F,G,H,J,K,L,M,N,P,Q,R,S,T,W,X,Y,Z,1,2,3,4,5,6,7,8,9,0".split(","),s=l.length,i=0;i<=3;i++){var d=Math.floor(Math.random()*s),h=10*Math.random()*Math.PI/180,m=l[d];t+=m.toLowerCase();var u=4+13*i,$=15;n.font="bold 16px 微软雅黑",n.translate(u,$),n.rotate(h),n.fillStyle="rgb(0,0,0)",n.fillText(m,0,0),n.rotate(-h),n.translate(-u,-$)}console.log(t);for(i=0;i<=2;i++)n.strokeStyle=randomColor(),n.beginPath(),n.moveTo(Math.random()*e,Math.random()*o),n.lineTo(Math.random()*e,Math.random()*o),n.stroke();for(i=0;i<=30;i++){n.strokeStyle=randomColor(),n.beginPath();u=Math.random()*e,$=Math.random()*o;n.moveTo(u,$),n.lineTo(u+1,$+1),n.stroke()}return t}function randomColor(){return"rgb("+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+")"}$(function(){var a="";a=draw($("#canvas")),$(".change").on("click",function(){a=draw($("#canvas"))}),$registerBtn=$("#registerBtn"),$registerBtn.on("click",function(){if($username=$("#username").val(),$password=$("#password").val(),$email=$("#email").val(),$sex=$("#sex").val(),$yanzheng_input=$(".yanzheng_input").val(),$yanzheng_input!=a)return alert("验证码错误!"),$(".yanzheng_input").val(""),void(a=draw($("#canvas")));$.ajax({type:"get",url:"http://47.104.244.134:8080/username.do",data:{username:$username},success:function(a){"1"==a.code?$.ajax({type:"get",url:"http://47.104.244.134:8080/useremail.do",data:{email:$email},success:function(a){"1"==a.code?($.ajax({type:"post",url:"http://47.104.244.134:8080/usersave.do",data:{username:$username,password:$password,email:$email,sex:$sex},success:function(a){console.log(a)}}),alert("注册成功"),location.href="login.html"):alert("邮箱已存在！")}}):alert("用户名已存在！")}})})});