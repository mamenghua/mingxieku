"use strict";$(function(){$("#header").load("../html/header.html");var i=window.location.search.split("=")[1];$.ajax({type:"get",url:"http://47.104.244.134:8080/goodsbyid.do",data:{id:i},success:function(t){console.log(t);var n="",s="";n+='<div class="bigImg">\n\t\t\t\t\t<img src="'+t.picurl+'"/>\n\t\t\t\t\t<div class="zoomBox"></div>\n\t\t\t\t\t<div class="rightImgBox">\n\t\t\t\t\t\t<img src="'+t.picurl+'"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<ul class="smallImg clearfix">\n\t\t\t\t\t<li class="current">\n\t\t\t\t\t\t<a href="#">\n\t\t\t\t\t\t\t<img src="'+t.picurl+'"/>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<a href="#">\n\t\t\t\t\t\t\t<img src="../img/login.jpg"/>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>',s+='<h3 class="title">'+t.name+'</h3>\n\t\t\t\t<ul class="goods-price">\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<span>吊&nbsp;&nbsp;牌&nbsp;&nbsp;价：</span>\n\t\t\t\t\t\t<del>￥'+t.price+'.00</del>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<span>销&nbsp;&nbsp;售&nbsp;&nbsp;价：</span>\n\t\t\t\t\t\t<span class="price">￥'+t.price+'.00</span>\n\t\t\t\t\t\t&nbsp;&nbsp;(&nbsp;1.7折&nbsp;)&nbsp;&nbsp;\n\t\t\t\t\t\t<span>立省：￥496.00</span>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<span>好&nbsp;&nbsp;评&nbsp;&nbsp;度：</span>\n\t\t\t\t\t\t&nbsp;\n\t\t\t\t\t\t<span class="comBar">\n\t\t\t\t\t\t\t<i></i>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t&nbsp;&nbsp;5分&nbsp;&nbsp;\n\t\t\t\t\t\t（已有3人评价）\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t运&nbsp;&nbsp;&emsp;&nbsp;&nbsp;费：\n\t\t\t\t\t\t&nbsp;&nbsp;名鞋库会员满399包邮&nbsp;&nbsp;\n\t\t\t\t\t\t（不包括货到付款）\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t\t<table class="specinfo">\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<th>尺码：</th>\n\t\t\t\t\t\t<td>37</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<th>颜色：</th>\n\t\t\t\t\t\t<td></td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<th>购买数量：</th>\n\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t<span class="numadjust decrease"></span>\n\t\t\t\t\t\t\t<input type="text" class="goodsNum" size=5 value="1">\n\t\t\t\t\t\t\t<span class="numadjust increase"></span>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t\t<div class="btnBar clearfix">\n\t\t\t\t\t<span class="goods_info">您购买了 <i class="buyNums">1</i>件 <i class="buyCm">37</i>码 黑色</span>\n\t\t\t\t\t<input type="button" class="addCartBtn" />\n\t\t\t\t\t<input type="button" class="fastBuyBtn" />\n\t\t\t\t</div>\n\t\t\t\t<div class="baozhang">\n\t\t\t\t\t<i>名鞋库保障：</i>&nbsp;\n\t\t\t\t\t<img src="../img/baozhang_img1.png"/>\n\t\t\t\t\t&nbsp;正品保证&nbsp;&nbsp;&nbsp;&nbsp;\n\t\t\t\t\t<img src="../img/baozhang_img2.png"/>\n\t\t\t\t\t&nbsp;自由退货&nbsp;&nbsp;&nbsp;&nbsp;\n\t\t\t\t\t<img src="../img/baozhang_img3.png"/>\n\t\t\t\t\t&nbsp;全场满399免邮\n\t\t\t\t</div>',$(".imgArea").html(n),$(".infoArea").html(s),$(".decrease").on("click",function(){var t=parseInt($(".goodsNum").val());--t<1&&(t=1),$(".goodsNum").val(t),$(".buyNums").text(t)}),$(".increase").on("click",function(){var t=parseInt($(".goodsNum").val());t++,$(".goodsNum").val(t),$(".buyNums").text(t)}),$(".goodsNum").on("change",function(){var t=$(this).val();t<1&&(t=1,$(this).val(t)),$(".buyNums").text(t)}),$(".goodsNum").on("input",function(){var t=$(this).val();t=t.replace(/\D/g,""),$(this).val(t)}),$(".addCartBtn").on("click",function(){var s=parseInt($(".goodsNum").val());$.cookie("token");$.get("http://47.104.244.134:8080/cartlist.do",{token:$.cookie("token")},function(t){for(var n in t)if(t[n].gid==i)return void $.get("http://47.104.244.134:8080/cartupdate.do",{id:t[n].id,gid:i,num:s,token:$.cookie("token")},function(t){alert("成功加入"+s+"条到购物车!")});$.get("http://47.104.244.134:8080/cartsave.do",{gid:i,token:$.cookie("token")},function(t){"0"==t.code?1!=s?$.get("http://47.104.244.134:8080/cartlist.do",{token:$.cookie("token")},function(t){for(var n in t)t[n].gid==i&&$.ajax({type:"get",url:"http://47.104.244.134:8080/cartupdate.do",data:{id:t[n].id,gid:i,num:s-1,token:$.cookie("token")},success:function(t){alert("成功加入"+s+"条到购物车!")}})}):alert("成功加入1条到购物车!"):alert("添加购物车失败!")})})}),$(".smallImg li").on("click",function(){$(this).addClass("current").siblings().removeClass("current"),$(".bigImg img").prop("src",$(this).find("img").prop("src")),$(".rightImgBox img").prop("src",$(this).find("img").prop("src"))}),$(".bigImg").on("mouseover",function(t){t||event;$(".zoomBox").css({display:"block"}),$(".rightImgBox").css({display:"block"}),$(this).on("mousemove",function(t){var n=t||event,s=$(".bigImg").width()-$(".zoomBox").width(),i=$(".bigImg").height()-$(".zoomBox").height(),o=n.pageX-parseInt($(".bigImg").position().left)-$(".zoomBox").width()/2,a=n.pageY-parseInt($(".bigImg").position().top)-$(".zoomBox").height()/2;o=o<=0?0:s<o?s:o,a=a<=0?0:i<a?i:a,$(".zoomBox").css({left:o,top:a}),$(".rightImgBox img").css({left:-o*$(".rightImgBox").width()/$(".zoomBox").width(),top:-a*$(".rightImgBox").height()/$(".zoomBox").height()})}),$(this).on("mouseout",function(){$(".zoomBox").css({display:"none"}),$(".rightImgBox").css({display:"none"})})})}})});